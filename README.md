# 3D Breast Cancer Segmentation using MRI and nnU-Net

This repository presents a complete deep learning pipeline for **3D breast cancer segmentation** using volumetric MRI data and the **nnU-Net architecture**. It leverages the BreastDM dataset to identify tumor regions with high spatial precision in the subtraction (SUB2) modality.

---

## Project Structure

```bash
.
â”œâ”€â”€ 1_dataprep_&_preprocessing.ipynb              # Data loading, normalization, padding
â”œâ”€â”€ 2_training.ipynb                              # 3D nnU-Net model training (PyTorch)
â”œâ”€â”€ 3_inference.ipynb                             # Inference on test samples
â”œâ”€â”€ 4_postprocessing_visualization_evaluation.ipynb  # Postprocessing, visualization, evaluation
â”œâ”€â”€ sample_output/                                # (Optional) Small sample predictions for quick testing
â””â”€â”€ README.md



## ğŸ“‚ Data & Results Access

All large data used and generated by the pipeline is hosted on Google Drive:

ğŸ”— [**Google Drive Folder â€“ Breast Cancer Segmentation Data & Outputs**](https://drive.google.com/drive/folders/1qsWCs7Kgdx3kHS0HAzy1GjV-gVhqODOI?usp=sharing)

Contents include:
- `preprocessed_data/`: Preprocessed `.npy` volumes used for model input
- `results/`: Predicted 3D masks and overlays
- `nnUNet_trained_models/`: Trained model weights, logs, and configuration
- `predictions/`: Inference outputs for test data
- `evaluation/`: Dice score, IoU, sensitivity, and other metrics
- `progress_plots/`: Training/validation curves
- `fingerprints.json`: nnU-Net config fingerprints for reproducibility

> ğŸ” The folder is shared in read-only mode for reproducibility and model re-use.

---

## ğŸ“Š Dataset: BreastDM

- **Patients**: 262
- **Modalities** per patient:
  - `SUB2.npy`: Subtraction image (used for model training)
  - `VIBRANT.npy`, `VIBRANT+C2.npy`: Not used in this project
- **Format**: 3D `.npy` volumes of shape `(H, W, D)`
- **Mask**: Binary ground truth masks for tumor regions
- **Data Splits**: `train/`, `val/`, and `test/` (each with `images/` and `labels/` subfolders)

> Input tensors are padded and reshaped to fixed shapes like `(8, 3, 369, 369)` or `(6, 3, 369, 369)`.

---

## ğŸ§  Model Overview: nnU-Net (3D)

The model is a 3D implementation of the popular nnU-Net framework. Key features:

- Fully convolutional 3D segmentation architecture
- Automatic adaptation to patch sizes and resolution
- Works directly on 3D MRI volumes (`SUB2.npy`)
- Postprocessing pipeline to enhance segmentation quality

---

## ğŸ› ï¸ Pipeline Steps

### 1. ğŸ§¼ Data Preprocessing  
ğŸ“„ `1_dataprep_&_preprocessing.ipynb`

- Loads `SUB2.npy` volumes and their corresponding labels
- Normalizes intensities
- Pads volumes to consistent shape
- Saves preprocessed volumes to disk for model input

---

### 2. ğŸ§  Model Training  
ğŸ“„ `2_training.ipynb`

- Implements 3D nnU-Net using PyTorch
- Trains model on preprocessed data
- Logs metrics and saves checkpoints to Drive

---

### 3. ğŸ” Inference  
ğŸ“„ `3_inference.ipynb`

- Loads trained model
- Predicts tumor masks on test samples
- Saves predictions to disk

---

### 4. ğŸ§¹ Postprocessing & Evaluation  
ğŸ“„ `4_postprocessing_visualization_evaluation.ipynb`

- Applies connected component filtering to clean predictions
- Computes:
  - Dice Score
  - Intersection over Union (IoU)
  - Sensitivity
  - Specificity
- Visualizes:
  - Ground truth vs predicted masks
  - Overlay on original slices
